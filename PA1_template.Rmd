---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

temp <- tempfile()
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", temp, mode="wb", method="curl")
unzip(temp, "activity.csv")
activityData <- read.table("activity.csv", sep=",", header = T)

totalSteps <- aggregate(steps ~ date, data = activityData, sum, na.rm = T)


## What is mean total number of steps taken per day?
hist(totalSteps$steps, 
     main = "Histogram of Total Steps taken per day",
     xlab = "Total Steps taken per day", 
     cex.axis = 1, cex.lab = 1)

#mean and median total no of steps taken per day
meanSteps <- mean(totalSteps$steps)
meanSteps

medianSteps <- median(totalSteps$steps)
medianSteps


## What is the average daily activity pattern?
stepsInterval <- aggregate(steps ~ interval, data = activityData, mean, na.rm = T)
plot(steps ~ interval, data = stepsInterval, type = "l", 
     main = "Average number of steps taken at 5 minute intervals",
     xlab = "Time Intervals(5-minute)", 
     ylab = "Mean Number of Steps taken (all days)")

#max no steps on avrg across all the days in the dataset
maxStepInterval <- stepsInterval[which.max(stepsInterval$steps), "interval"]
maxStepInterval


## Imputing missing values
missingData <- sum(!complete.cases(activityData))
missingData

#fill missing value
getStepsPerinterval <- function(interval){
  stepsInterval[stepsInterval$interval == interval, "steps"]
}


## Are there differences in activity patterns between weekdays and weekends?
fullAct <- activityData

flag = 0
for(i in 1:nrow(fullAct)){
  if(is.na(fullAct[i, "steps"])){
    fullAct[i, "steps"] <- getStepsPerinterval(fullAct[i, "interval"])
    flag = flag + 1
  }
}

flag

#hist of the no of steps taken each day
newTotalStepsPerDays <- aggregate(steps ~ date, data = fullAct, sum)
hist(newTotalStepsPerDays$steps, 
     main = "Histogram of total number of steps taken each day",
     xlab = "Total number of steps", 
     ylab = "Frequency")

meanNewData <- mean(newTotalStepsPerDays$steps)
meanNewData

medianNewData <- median(newTotalStepsPerDays$steps)
medianNewData


#difference in activity pattern between weekdays and weekends 
weekData <- activityData 
weekData$day <- ifelse(as.POSIXlt(as.Date(weekData$date))$wday%%6
                       == 0, "weekend", "weekday")
weekData$day <- factor(weekData$day, levels = c("weekday", "weekend"))

interval <- aggregate(steps ~ interval + day, weekData, mean)

library(lattice)
xyplot(steps ~ interval | day, data = interval, layout = c(1, 2), type = "l", 
       main = "Weekend vs Avg Steps",
       xlab = "Interval(Steps)", 
       ylab = "Average Steps")
